<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<title>Prompt Manager</title>

<style>
  body {
    background:#111;
    color:#eee;
    font-family:Arial, sans-serif;
    margin:0;
    padding:0;
  }

  header {
    background:#222;
    padding:10px 20px;
    display:flex;
    align-items:center;
    justify-content:space-between;
    gap:15px;
  }

  header button {
    margin-right:10px;
  }

  .page {
    display:none;
    padding:20px;
  }

  .active { display:block; }

  textarea, input {
    width:100%;
    background:#222;
    color:#eee;
    border:1px solid #444;
    padding:10px;
    margin-bottom:15px;
  }

  button {
    background:#333;
    color:#eee;
    border:1px solid #555;
    padding:10px 15px;
    cursor:pointer;
  }

  button:hover {
    background:#444;
  }

  /* GRID LAYOUT */
  #promptList {
    display:grid;
    grid-template-columns:repeat(auto-fill, minmax(150px,1fr));
    gap:15px;
  }

  #promptList button {
    height:120px;
    border-radius:10px;
    font-size:14px;
    padding:10px;
    display:flex;
    justify-content:center;
    align-items:center;
    text-align:center;
    transition:transform 150ms ease, background 150ms ease, opacity 150ms ease;
  }

  /* highlight copied tiles */
  .copied {
    background:#A970FF !important;
    box-shadow:0 0 10px #A970FF;
  }

  /* dragging */
  #promptList button[draggable="true"] { cursor:move; }

  .dragging {
    opacity:0.3;
    transform:scale(0.9);
  }

  /* smooth hover swap animation */
  .swap-hover {
    transform:scale(1.06);
    background:#555;
  }

  .context-menu {
    position:absolute;
    background:#222;
    border:1px solid #555;
    display:none;
    z-index:1000;
  }

  .context-menu div {
    padding:10px;
    cursor:pointer;
  }

  .context-menu div:hover {
    background:#444;
  }

  #toast {
    position:fixed;
    bottom:20px;
    right:20px;
    background:#333;
    padding:10px 20px;
    border-radius:5px;
    display:none;
  }

</style>
</head>

<body>

<header>
  <div>
    <button onclick="showPage('savePage')">Save Prompt</button>
    <button onclick="showPage('collectionPage')">Prompt Collection</button>
  </div>

  <!-- YOU CAN ADD SEARCH HERE LATER -->

  <div>
    <button onclick="exportPrompts()">Export</button>
    <button onclick="importPrompts()">Import</button>
    <button onclick="resetAll()">Reset All</button>
  </div>
</header>

<!-- SAVE PAGE -->
<div id="savePage" class="page active">
  <h2>Save Prompt</h2>
  <input id="heading" placeholder="Heading" />
  <textarea id="prompt" rows="10" placeholder="Prompt text..."></textarea>

  <div style="text-align:center;">
    <button onclick="savePrompt()" style="margin:auto;">Save</button>
  </div>
</div>

<!-- COLLECTION PAGE -->
<div id="collectionPage" class="page">
  <h2>Prompt Collection</h2>
  <div id="promptList"></div>
</div>

<!-- CONTEXT MENU -->
<div id="contextMenu" class="context-menu">
  <div onclick="viewPrompt()">View Prompt</div>
  <div onclick="editPrompt()">Edit Prompt</div>
  <div onclick="deletePrompt()">Delete Prompt</div>
</div>

<div id="toast"></div>

<script>
let prompts = JSON.parse(localStorage.getItem('prompts') || '[]');
let currentRightClick = null;
let draggedIndex = null;

/* PAGE SWITCH */
function showPage(pg){
  document.querySelectorAll('.page').forEach(p => p.classList.remove('active'));
  document.getElementById(pg).classList.add('active');

  if(pg === 'collectionPage') loadPrompts();
}

/* SAVE PROMPT */
function savePrompt(){
  let heading = document.getElementById('heading').value.trim();
  let prompt = document.getElementById('prompt').value.trim();

  if(!heading || !prompt){ alert('Both fields required'); return; }

  prompts.push({ heading, prompt });
  localStorage.setItem('prompts', JSON.stringify(prompts));

  alert('Saved!');

  document.getElementById('heading').value = '';
  document.getElementById('prompt').value = '';
}

/* LOAD TILES WITH DRAGGING + SMOOTH SWAP */
function loadPrompts(){
  let list = document.getElementById('promptList');
  list.innerHTML = '';

  prompts.forEach((p,i)=>{
    let btn = document.createElement('button');
    btn.textContent = p.heading;

    /* COPY */
    btn.onclick = () => {
      navigator.clipboard.writeText(p.prompt);
      btn.classList.add("copied");
      toast("Prompt Copied");
    };

    /* RIGHT CLICK */
    btn.oncontextmenu = (e)=>{
      e.preventDefault();
      openMenu(e,i);
    };

    /* DRAGGING */
    btn.draggable = true;

    btn.ondragstart = () => {
      draggedIndex = i;
      btn.classList.add("dragging");
    };

    btn.ondragend = () => {
      btn.classList.remove("dragging");
    };

    btn.ondragover = (e) => {
      e.preventDefault();
      btn.classList.add("swap-hover");
    };

    btn.ondragleave = () => {
      btn.classList.remove("swap-hover");
    };

    btn.ondrop = () => {
      btn.classList.remove("swap-hover");

      // swap positions
      let temp = prompts[draggedIndex];
      prompts[draggedIndex] = prompts[i];
      prompts[i] = temp;

      localStorage.setItem("prompts", JSON.stringify(prompts));
      loadPrompts();
    };

    list.appendChild(btn);
  });
}

/* CONTEXT MENU */
function openMenu(e,i){
  currentRightClick = i;
  let menu = document.getElementById('contextMenu');
  menu.style.left = e.pageX + 'px';
  menu.style.top = e.pageY + 'px';
  menu.style.display = 'block';
}

window.onclick = () => {
  document.getElementById('contextMenu').style.display = 'none';
};

/* RIGHT CLICK ACTIONS */
function viewPrompt(){
  alert(prompts[currentRightClick].prompt);
}

function editPrompt(){
  let np = prompt('Edit prompt', prompts[currentRightClick].prompt);
  if(np !== null){
    prompts[currentRightClick].prompt = np;
    localStorage.setItem('prompts', JSON.stringify(prompts));
    alert('Updated');
    loadPrompts();
  }
}

function deletePrompt(){
  if(confirm('Delete this prompt?')){
    prompts.splice(currentRightClick,1);
    localStorage.setItem('prompts', JSON.stringify(prompts));
    loadPrompts();
  }
}

/* TOAST MESSAGE */
function toast(msg){
  let t = document.getElementById('toast');
  t.textContent = msg;
  t.style.display = 'block';
  setTimeout(()=>t.style.display='none', 2000);
}

/* RESET ALL */
function resetAll(){
  if(confirm("Delete everything?")){
    prompts = [];
    localStorage.removeItem('prompts');
    loadPrompts();
  }
}

/* EXPORT */
function exportPrompts(){
  let data = JSON.stringify(prompts);
  let blob = new Blob([data], {type:'application/json'});
  let a = document.createElement('a');
  a.href = URL.createObjectURL(blob);
  a.download = 'prompts.json';
  a.click();
}

/* IMPORT */
function importPrompts(){
  let inp = document.createElement('input');
  inp.type = 'file';
  inp.accept = 'application/json';

  inp.onchange = (e)=>{
    let file = e.target.files[0];
    let reader = new FileReader();

    reader.onload = () => {
      prompts = JSON.parse(reader.result);
      localStorage.setItem("prompts", JSON.stringify(prompts));
      alert("Imported!");
      loadPrompts();
    };

    reader.readAsText(file);
  };

  inp.click();
}
</script>

</body>
</html>
